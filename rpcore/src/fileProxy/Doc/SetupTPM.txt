Instructions for setting up the TPM
===================================

install trousers
sudo agt-get install trousers
sudo agt-get install tpm-dev
sudo agt-get install tpm-tools
sudo agt-get install libtspi-dev


Enable and activate the TPM in BIOS and make sure TXT and vt-d 
is enabled too.  After enabling the TPM in BIOS, type:
    sudo bash
    tscd start
    tpm_takeownership -z -y
    tpm_getpubek
Note: If someone has already taken ownership, you must disable the tpm and 
reenable it.  You may have to remove power to reset the TPM and you may 
have to create an endorsement key using
    tpm_createek

You need to compile a tool to make an AIK key.
    cd Code/TPMUser

Set your object paths and make the object directories in the makefile
as specified in DirectoryStructure.txt.  Then type:
    make -f vTCI.mak
    cd ROOT
    mkdir HW
    ./vTCI.exe -initAIK 

This command puts the generated AIK Blob file in the subdirectory ROOT/HW/aikblob.
The location of the aikblob file can be changed with flags (call vTCI.exe -help
to find out how).  This blob file will be needed later.

Copy ROOT/HW/aikblob to ROOT/HWRoot/aikcreds and copy ROOT/HW/aikblob to ROOT/HWRoot/privatekey

Finally, the aikhexmod.txt file must be a hex copy of aikKeyFile.txt. So, run the command

    xxd -ps -c 32 HW/aikKeyFile.txt > HWRoot/aikhexmod.txt


----------------------------------

Enabling the TPM varies from computer to computer.  For example, on HP8470p, the TPM is
enables using a utility (HP Protect tools) obtained from:
  http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareDescription.jsp?lang=en&cc=us&prodTypeId=321957&prodSeriesId=4095872&prodNameId=4095876&swEnvOID=4059&swLang=13&mode=2&taskId=135&swItem=ob-98212-1
and
http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareDescription.jsp?lang=en&cc=us&prodTypeId=321957&prodSeriesId=4095872&prodNameId=4095876&swEnvOID=4059&swLang=13&mode=2&taskId=135&swItem=ob-79350-1

Unfortunately, they only run on windows.

You can activate from software (trousers) if you are in single user mode.  The sequence of
instructions is:

telinit S or boot to single user mode
ifup lo
start tcsd
tpm_setpresence --assert
tpm_setenable --enable --force
tpm_setactive --activate --force
reboot



